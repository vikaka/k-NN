{
    "contents" : "---\ntitle: \"bonus points\"\nauthor: \"Vishesh Kakarala\"\ndate: \"March 1, 2016\"\noutput: html_document\n---\n#Bonus Points\n\n# to determine which predictors are good we can use linear modelling to determine their significance\n```{r}\nlm_multiple <- lm(glass$bi~glass$RI +glass$Na +glass$Mg+glass$Al+glass$Si+glass$K+glass$Ca+glass$Ba+glass$Fe+glass$`Type of glass`)\n\nsummary(lm_multiple)\n```\n# from the analysis of the summary we find that the variables Na, Al, SI and K have significant influence on the response vector\n\n```{r}\n\nfeatures <- glass[,-1]\nfeatures <- features[,-11]\nfeatures <- features[,-10]\nfeatures <- features[,-1]\nfeatures <- features[,-2]\nfeatures <- features[,-5]\nfeatures <- features[,-5]\nfeatures <- features[,-5]\n\ncolnames(features)\n# only the significant varibales are used in the feature matrix\n\nfea_sig <- data.frame(features)\n# y is the response vector\n\ny_sig <- data.frame(glass$bi)\n```\n\n#### The rest of the process is followed as above\n\ntraining - 80% \ntesting - 30%\nwe need a larger training data set for better model fit  \n\n```{r}\n#sample is taken from the original data and the corresponding respone variables are also split\ntrain_fea_sig <- sample_frac(fea_sig,0.8)\ntrain_y_sig <- data.matrix(y[as.numeric(rownames(train_fea_sig)),])\n\ntrain_values_sig <- as.numeric(rownames(train_fea_sig))\n\ntest_fea_sig <- fea[-train_values_sig,]\ntest_y_sig <- data.matrix(y[as.numeric(rownames(test_fea_sig)),])\n\n\ntrain_fea_sig <- data.matrix(train_fea_sig)\n\ntest_fea_sig <- data.matrix(test_fea_sig)\n\n#the training and test data is stored in matrix form\n```\n\n\n```{r}\n# From the class package, we use knn.cv to validate the exisitng response variables \n# kNN of order 5 is used\n\nfit_knn_sig <- knn.cv(train_fea_sig,train_y_sig,k= 5)\n\n# the output is used as the new response varible and is used to predict test values\n```\n\n\n\n```{r}\n# Using the testing set and the training data predictions are made \n\ncheck_test_sig <-data.frame(knn(train_fea_sig,test_fea_sig,train_y_sig, k= 5))\ncheck_test_sig$a <- test_y_sig\n\ncolnames(check_test_sig) <- c(\"Model output\",\"original data\")\n\n\ncheck_test_sig$`Model output`<-data.frame(check_test_sig$`Model output`)\n\nfor (i in 1:43)\n{\n  if(check_test_sig$`Model output`[i,] == check_test_sig$`original data`[i,])\n  {\n    check_test_sig$accuracy[i] <- 1\n  }\n  else\n  {\n    check_test_sig$accuracy[i] <- 0\n  }\n  i= i+1\n  \n}\n\nsum(check_test$accuracy)/43\n\n# accuracy of the kNN model of order 5 is 90%\n\n```\n\n\n\n```{r}\n\n#to compute the accuracy value for various levels of kNN\n# we must first initialise a storage data frame\n\naccuracy_test_4 <- data.frame(5:25)\n\n\nfor(j in 1:20)\n{\n  check_test_sig <-data.frame(knn(train_fea_sig,test_fea_sig,fit_knn_sig, k= j+4))\n  check_test$a <- test_y\n\n  colnames(check_test_sig) <- c(\"Model output\",\"original data\")\n\n  check_test_sig$`Model output`<-data.frame(check_test_sig$`Model output`)\n\n  for (i in 1:43)\n    {\n      if(check_test_sig$`Model output`[i,] == check_test_sig$`original data`[i,])\n        {\n          check_test_sig$accuracy[i] <- 1\n        }\n      else\n        {\n          check_test_sig$accuracy[i] <- 0\n        }\n    i= i+1\n  \n    }\n\n  accuracy_test_4$k_value[j] <- j+4\n  accuracy_test_4$Accuracy[j] <- sum(check_test$accuracy)/43\n  \n\n}\naccuracy_test_4 <- accuracy_test_4[-1] \naccuracy_test_4 <- accuracy_test_4[-21,] \n\n# the data frame accuracy_test_4 contains the accuracy values for a reasonable range of K values\n```\n\n\n```{r}\nplot(accuracy_test_4$k_value,accuracy_test_4$Accuracy, type = \"l\")\n```\n\nOptimal value for k is 12 or 14  \n\n\nBy analysing the test class we can calculate the testing accuracy\n```{r}\ntable(test_y_sig)\n```\nHere we can see that out of the 43 values there are 32 0's and 11 1's, hence to calculate null accuracy we get.  \n\n```{r}\n32/43\n```\n\nThus null accuracy is at 74%.    \n",
    "created" : 1456824430642.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4083913978",
    "id" : "B80D9112",
    "lastKnownWriteTime" : 1456829944,
    "path" : "~/Homework 2/bonus points.Rmd",
    "project_path" : "bonus points.Rmd",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 10,
    "source_on_save" : false,
    "type" : "r_markdown"
}